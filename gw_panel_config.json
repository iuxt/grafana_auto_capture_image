{
    "name": "长城",
    "uid": "gw-service",
    "panels": [
        {
            "title": "域名证书到期时间",
            "id": "23763571997",
            "expr": "(probe_ssl_earliest_cert_expiry{project=~\"gw\", env=~\"prod\", k8s=\"gw\"} - time() ) / 3600 /24",
            "get_value": "min"
        },
        {
            "title": "数字钥匙HTTP访问量",
            "id": "2",
            "expr": "sum(increase(nginx_ingress_controller_requests{ project=~\"gw\", env=~\"prod\",k8s=\"gw\"}[1m])) by (ingress)",
            "get_value": "max"
        },
        {
            "title": "数字钥匙HTTP服务-延迟响应水位线90分位",
            "id": "16",
            "expr": "histogram_quantile(0.90, sum(rate(nginx_ingress_controller_request_duration_seconds_bucket{project=~\"gw\", status!=\"404\",status!=\"500\",k8s=\"gw\"}[1m])) by (le, ingress))",
            "get_value": "max"
        },
        {
            "title": "MySQL资源总览表",
            "id": "2085",
            "expr": "",
            "get_value": ""
        },
        {
            "title": "MySQL连接数",
            "id": "2090",
            "expr": "mysql_info_schema_processlist_processes_by_user{env=~\"prod\",project=~\"gw\",k8s=\"gw\"}",
            "get_value": "max"
        },
        {
            "title": "MySQL每分钟慢查询数量",
            "id": "2091",
            "expr": "delta(mysql_global_status_slow_queries{env=~\"prod\",project=~\"gw\",k8s=\"gw\"}[1m])",
            "get_value": "max"
        },
        {
            "title": "MySQL表占用磁盘概览Top10",
            "id": "2092",
            "expr": "topk(10, sum(mysql_info_schema_table_size{env=~\"prod\",project=~\"gw\",k8s=\"gw\",component!=\"data_free\"}) by (schema, table)) > 0",
            "get_value": "max"
        },
        {
            "title": "MySQL表数据量Top10",
            "id": "2093",
            "expr": "topk(10, sum(mysql_info_schema_table_rows{env=~\"prod\",project=~\"gw\",k8s=\"gw\"}) by (schema, table)) > 0",
            "get_value": "max"
        },
        {
            "title": "服务器资源总览表",
            "id": "2073",
            "expr": "",
            "get_value": ""
        },
        {
            "title": "节点CPU使用率",
            "id": "2081",
            "expr": "1 - avg(irate(node_cpu_seconds_total{env=\"prod\",project=\"gw\",k8s=\"gw\",mode=\"idle\"}[3m])) by (instance)",
            "get_value": "max"
        },
        {
            "title": "节点平均负载",
            "id": "23763571998",
            "expr": "node_load1{project=~\"gw\", env=~\"prod\",k8s=\"gw\"}",
            "get_value": "max"
        },
        {
            "title": "节点磁盘使用率",
            "id": "23763571999",
            "expr": "1-(node_filesystem_free_bytes{env=\"prod\",project=\"gw\",fstype=~\"ext4|xfs|ext3\",mountpoint=~\"/|/opt/docker\",k8s=\"gw\"} / node_filesystem_size_bytes{env=\"prod\",project=\"gw\",fstype=~\"ext4|xfs|ext3\",mountpoint=~\"/|/opt/docker\",k8s=\"gw\"})",
            "get_value": "max"
        },
        {
            "title": "节点内存使用率",
            "id": "2082",
            "expr": "1 - (node_memory_MemAvailable_bytes{env=\"prod\",project=\"gw\",k8s=\"gw\"} / node_memory_MemTotal_bytes{env=\"prod\",project=\"gw\",k8s=\"gw\"})",
            "get_value": "max"
        },
        {
            "title": "SDK服务内存使用量",
            "id": "2102",
            "expr": "sum by(pod) (container_memory_rss{project=\"gw\",env=\"prod\",namespace=\"default\",k8s=\"gw\",name=~\"^k8s_.*|^[0-9a-z]{64}\"})",
            "get_value": "max"
        },
        {
            "title": "SDK服务重启次数",
            "id": "2103",
            "expr": "sum by (pod) (increase(kube_pod_container_status_restarts_total{project=\"gw\", namespace=\"default\",k8s=\"gw\" }[$__range]))",
            "get_value": "max"
        }
    ]
}